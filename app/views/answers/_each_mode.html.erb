
<div id="question_answer" style="min-height: 300px;">

  <%= form_for  @answer, html: { onsubmit: "set_flag();"} do |f| %>


      <table align="right"  width="100%"  >
        <tr>
          <td class="lft" width="75%"  >
            Question Category:<%= @answer.question.category.category %>
          </td>
          <td>
            <div class="countdown1" align="right"  >Time Remaining:  </div>
          </td>
          <td>
            <div id="count" class="countdown" align="right "  ></div>
          </td>
        </tr>
      </table>



      <br/>



      <br/>

      <%=f.hidden_field   :dec_time ,:value =>@answer.dec_time %>


      <div class="qno"  >

        <b>  <%= label_tag @answer.q_no%></b>
      </div>
      <div class="question"  >
        <%=simple_format @answer.question.question %><br/>
        <% if !@answer.question.question_image.to_s.include?("missing.png") %>
            <%= image_tag @answer.question.question_image.url(:original) %><br/>
        <% end %>
      </div>

      <table cellpadding="0"  width="100%" class="question" >

        <% if @answer.question.type.question_type=="check_box" %>

            <% @answer.question.options.sort.each_with_index do |op,i| %>
                <tr>
                  <%= f.fields_for :c_option do |c_op| %>
                      <td width="2%" ><%=  c_op.check_box  op.id,:checked => @tick[i] %></td>
                      <td class="lft" ><%= c_op.label op.id,op.option %></td>
                  <% end %>
                </tr>
            <% end %>

        <% else %>
            <% @answer.question.options.sort.each_with_index do |op,i| %>
                <tr >
                  <%= f.fields_for :c_option do |c_op| %>
                      <td width="2%"  ><%=  c_op.radio_button 1, op.id,:checked => @tick[i]%></td>
                      <td class="lft"  >   <%=  c_op.label op.id,op.option %>  </td>
                  <% end %>
                </tr>
            <% end %>

        <% end %>



      </table>

      </b><br/>

      </div>
      <%= f.submit   :id =>"procedure_submit_button" , :name=>"to",:value=>"timer" , :style => "display: none" ,:remote  => true%>

      <table cellpadding="5" align="center"   >
        <tr>
          <% if current_user.candidate.answer_ids.include?(@answer.id+1)   %>
              <td><%= f.button  "Next", :name=>"to",:value=>@answer.id+1, :disable_with => "Next",class: "btn btn-large btn-primary", :disable_with => "Next", confirm: "as"%></td>
          <% end %>
          <td><%= f.button 'Submit my Exam', :name=>"to",:value=>"finish",class: "btn btn-large btn-warning",:title=>"Submit your exam" , :disable_with =>'Finish',:onclick=>"show_submitting();"%></td>
        </tr>
      </table>


      <br/>Please click on the question number button to load the question. Or click Next to load next question <br/>
      <h3>Questions:</h3>
      <% @candidate.answers.sort.each_with_index do |ans,i| %>

          <% if (ans.question.allowed_time-ans.time_taken)>3 %>

              <% if ans.answer!="0"&&ans.id!=@answer.id  %>
                  <%= f.button  i+1, :name=>"to",:value=>ans.id, :disable_with => i+1,:style=>"background-color: #90ee90;"  %>
              <% elsif ans.id==@answer.id  %>
                  <%= f.button  i+1, :name=>"to",:value=>ans.id, :disable_with => i+1 ,:style=>"background-color: orange;" %>
              <% else %>
                  <%= f.button  i+1, :name=>"to",:value=>ans.id, :disable_with => i+1 %>
              <% end %>
          <% else %>
              <%= f.button  i+1, disabled: true  %>
          <% end %>
      <% end %>


      <br/>
      <br/> Please call: 0484 4242800 for immediate assistance <br/>
  <% end %>

  <script type="text/javascript" >
      window.onload = function()
      {
          startCountdown(<%=cnt=@count%>)
      }

      var flag=0;
      function set_flag(){
          flag = 1;
      }
      function startCountdown(g_iCount)
      {
          if((g_iCount) > 0)
          {
              var str="green";
              if (g_iCount<20&&g_iCount>=10)
              {
                  str="orange"
              }
              else if (g_iCount<10)
              {
                  str="red"
              }


              document.getElementById('count').innerHTML=g_iCount.toString().fontcolor(str);

              g_iCount = g_iCount - 1;
              if (flag == 0){
                  setTimeout(function() {startCountdown(g_iCount); }, 1000);
              }
              else{
                  return;
              }
          }
          else
          {
              document.getElementById('procedure_submit_button').click();
          }
      }

      var message="Function Disabled!";


      function clickIE4(){
          if (event.button!=0){

              return false;
          }
      }

      function clickNS4(e){
          if (document.layers||document.getElementById&&!document.all){
              if (e.which==2||e.which==3){

                  return false;
              }
          }
      }

      if (document.layers){
          document.captureEvents(Event.MOUSEDOWN);
          document.onmousedown=clickNS4;
      }
      else if (document.all&&!document.getElementById){
          document.onmousedown=clickIE4;
      }

      document.oncontextmenu=new Function("return false")

      document.onkeydown = function(e){
          if(e.keyCode != 0)
          {
              return false;
          }

      }
  </script>
